<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
<title>실시간 금융 대시보드 - 자비스</title>

<!-- TradingView Core (Advanced Chart) -->
<script src="https://s3.tradingview.com/tv.js"></script>

<style>
:root{
  --bg:#0b1220;
  --text:#e7eefc;
  --muted:#9aa4b2;
  --border:rgba(255,255,255,.18);
  --card-bg:rgba(255,255,255,.10);
  --card-bg-2:rgba(255,255,255,.06);
  --up-color:#ff4d4d;
  --down-color:#4facfe;
}

*{ box-sizing:border-box; }

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans KR",sans-serif;
  background:radial-gradient(1200px 600px at 10% 0%, #152447 0%, var(--bg) 55%);
  color:var(--text);
  line-height:1.5;
}

/* ===== 요약 패널 ===== */
.summary-container{
  padding:16px;
  background:rgba(0,0,0,.10);
}

.summary-header{
  font-size:13px;
  font-weight:800;
  color:var(--muted);
  margin-bottom:15px;
  letter-spacing:1px;
}

.summary-grid{
  display:flex;
  flex-direction:column;
  gap:12px;
}

.summary-card{
  min-height:110px;
  padding:12px;
  border-radius:18px;
  background:var(--card-bg);
  border:1px solid var(--border);
  display:flex;
  flex-direction:column;
  justify-content:center;
}

/* 네이버 스타일 미국채 박스 */
.naver-box{
  text-decoration:none;
  color:inherit;
  cursor:pointer;
  transition:transform .2s;
}
.naver-box:active{ transform:scale(.98); }
.naver-label{ font-size:14px; color:var(--muted); margin-bottom:5px; }
.naver-price{ font-size:28px; font-weight:800; color:var(--up-color); display:flex; align-items:baseline; gap:8px; }
.naver-change{ font-size:14px; font-weight:500; }

/* ===== 메인 차트 영역 ===== */
main{
  max-width:1200px;
  margin:0 auto;
  padding:10px 16px 60px;
  display:grid;
  grid-template-columns:repeat(12, 1fr);
  gap:16px;
}

.card{
  grid-column:span 12;
  border-radius:20px;
  background:var(--card-bg);
  border:1px solid var(--border);
  overflow:hidden;
}

.card header{
  padding:14px 18px;
  font-size:15px;
  font-weight:700;
  background:rgba(255,255,255,.05);
}

.widget{ height:380px; }

/* US10Y 안내 패널 */
.notice{
  height:380px;
  padding:18px;
  background:var(--card-bg-2);
  display:flex;
  flex-direction:column;
  gap:10px;
  justify-content:center;
}

.notice-title{
  font-weight:800;
  font-size:14px;
}

.notice-text{
  color:var(--muted);
  font-size:13px;
}

.notice-actions{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  margin-top:6px;
}

.btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid var(--border);
  background:rgba(255,255,255,.06);
  color:var(--text);
  text-decoration:none;
  font-size:13px;
  font-weight:700;
}
.btn:active{ transform:scale(.98); }

/* 데스크탑 */
@media(min-width:900px){
  .summary-grid{ flex-direction:row; }
  .summary-card{ flex:1; min-height:130px; }
  .half{ grid-column:span 6; }
}
</style>
</head>

<body>

<!-- ✅ TradingView가 URL 파라미터로 심볼을 덮어쓰는 현상 방지 -->
<script>
(function blockTVSymbolHijack(){
  try{
    const url = new URL(location.href);
    if (url.searchParams.has("tvwidgetsymbol")) {
      url.searchParams.delete("tvwidgetsymbol");
      history.replaceState({}, "", url.toString());
      location.reload();
    }
  }catch(e){}
})();
</script>

<div class="summary-container">
  <div class="summary-header">● MARKET SNAPSHOT</div>
  <div class="summary-grid">

    <!-- USDKRW -->
    <div class="summary-card">
      <div class="tradingview-widget-container">
        <script src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>
        {
          "symbol": "FX_IDC:USDKRW",
          "width": "100%",
          "colorTheme": "dark",
          "isTransparent": true,
          "locale": "kr"
        }
        </script>
      </div>
    </div>

    <!-- WTI -->
    <div class="summary-card">
      <div class="tradingview-widget-container">
        <script src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>
        {
          "symbol": "TVC:USOIL",
          "width": "100%",
          "colorTheme": "dark",
          "isTransparent": true,
          "locale": "kr"
        }
        </script>
      </div>
    </div>

    <!-- US10Y (네이버 링크 박스 유지) -->
    <a href="https://m.stock.naver.com/worldstock/index/US10Y" target="_blank" class="summary-card naver-box" rel="noopener">
      <div class="naver-label">미국 국채 10년 (US10Y)</div>
      <div class="naver-price">
        <span id="us10y-val">4.1670</span>
        <span class="naver-change" style="color:var(--down-color)">▼ 0.0120 (-0.29%)</span>
      </div>
      <div style="font-size:11px; color:var(--muted); margin-top:5px;">네이버 증권에서 실시간 확인 ></div>
    </a>

  </div>
</div>

<main>
  <section class="card half">
    <header>USD/KRW 환율 차트</header>
    <div id="tv_usdkrw" class="widget"></div>
  </section>

  <!-- ✅ 여기: US10Y 차트 대신 안내 패널 (AAPL 튐 방지) -->
  <section class="card half">
    <header>미국채 10년물 금리 (US10Y)</header>
    <div class="notice">
      <div class="notice-title">TradingView “차트 위젯”에서 US10Y(금리)는 지원되지 않습니다.</div>
      <div class="notice-text">
        그래서 차트 영역이 종종 애플(AAPL) 등으로 자동 대체되는 현상이 생깁니다.<br/>
        위쪽 MARKET SNAPSHOT의 US10Y 박스와 아래 버튼을 사용해 주세요.
      </div>
      <div class="notice-actions">
        <a class="btn" href="https://m.stock.naver.com/worldstock/index/US10Y" target="_blank" rel="noopener">네이버 US10Y 열기</a>
        <a class="btn" href="https://tradingview.com/symbols/TVC-US10Y/" target="_blank" rel="noopener">TradingView US10Y 페이지</a>
      </div>
      <div class="notice-text" style="margin-top:6px;">
        * “차트”가 꼭 필요하면, 금리 대신 10년물 선물(ZN) 가격 차트로 대체할 수 있어요.
      </div>
    </div>
  </section>

  <section class="card half">
    <header>WTI 원유 선물 차트</header>
    <div id="tv_wti" class="widget"></div>
  </section>

  <section class="card half">
    <header>Brent 원유 선물 차트</header>
    <div id="tv_brent" class="widget"></div>
  </section>
</main>

<script>
function createChart(id, symbol){
  new TradingView.widget({
    autosize: true,
    symbol: symbol,
    interval: "60",
    timezone: "Asia/Seoul",
    theme: "dark",
    style: "1",
    locale: "kr",
    enable_publishing: false,
    hide_top_toolbar: true,
    hide_legend: false,
    allow_symbol_change: false,
    save_image: false,
    container_id: id
  });
}

window.addEventListener("load", function() {
  createChart("tv_usdkrw", "FX_IDC:USDKRW");
  createChart("tv_wti", "TVC:USOIL");
  createChart("tv_brent", "TVC:UKOIL");
});
</script>

</body>
</html>
