<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
<title>실시간 금융 대시보드</title>

<!-- TradingView Advanced Chart -->
<script src="https://s3.tradingview.com/tv.js"></script>

<style>
:root{
  --bg:#0b1220;
  --text:#e7eefc;
  --muted:#9aa4b2;
  --border:rgba(255,255,255,.18);
  --card-bg:rgba(255,255,255,.10);
}
*{ box-sizing:border-box; }

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans KR",sans-serif;
  background:radial-gradient(1200px 600px at 10% 0%, #152447 0%, var(--bg) 55%);
  color:var(--text);
  line-height:1.5;
}

/* ===== 요약 패널 (세로) ===== */
.summary-container{
  padding:16px;
  background:rgba(0,0,0,.10);
}

.summary-header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  margin-bottom:12px;
}

.summary-title{
  font-size:13px;
  font-weight:800;
  color:var(--muted);
  letter-spacing:1px;
}

.summary-ts{
  font-size:12px;
  color:var(--muted);
  white-space:nowrap;
}

.summary-grid{
  display:flex;
  flex-direction:column;
  gap:12px;
}

.summary-card{
  min-height:110px;
  padding:12px;
  border-radius:18px;
  background:var(--card-bg);
  border:1px solid var(--border);
  display:flex;
  flex-direction:column;
  justify-content:center;
}

.summary-footnote{
  margin-top:8px;
  font-size:11px;
  color:var(--muted);
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}

/* ===== 메인 차트 영역 ===== */
main{
  max-width:1200px;
  margin:0 auto;
  padding:10px 16px 60px;
  display:grid;
  grid-template-columns:repeat(12, 1fr);
  gap:16px;
}

.card{
  grid-column:span 12;
  border-radius:20px;
  background:var(--card-bg);
  border:1px solid var(--border);
  overflow:hidden;
}

.card header{
  padding:14px 18px;
  font-size:15px;
  font-weight:700;
  background:rgba(255,255,255,.05);
}

.widget{ height:380px; }

/* 데스크탑: 차트 2열 */
@media(min-width:900px){
  .half{ grid-column:span 6; }
}
</style>
</head>

<body>

<!-- ✅ TradingView가 URL 파라미터로 심볼을 덮어쓰는 현상 방지 -->
<script>
(function blockTVSymbolHijack(){
  try{
    const url = new URL(location.href);
    if (url.searchParams.has("tvwidgetsymbol")) {
      url.searchParams.delete("tvwidgetsymbol");
      history.replaceState({}, "", url.toString());
      location.reload();
    }
  }catch(e){}
})();
</script>

<div class="summary-container">
  <div class="summary-header">
    <div class="summary-title">● MARKET SNAPSHOT</div>
    <div class="summary-ts">로컬시간: <span id="ts">-</span></div>
  </div>

  <div class="summary-grid">
    <!-- USD/KRW -->
    <div class="summary-card">
      <div class="tradingview-widget-container">
        <script src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>
        {
          "symbol": "FX_IDC:USDKRW",
          "width": "100%",
          "colorTheme": "dark",
          "isTransparent": true,
          "locale": "kr"
        }
        </script>
      </div>
    </div>

    <!-- WTI -->
    <div class="summary-card">
      <div class="tradingview-widget-container">
        <script src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>
        {
          "symbol": "TVC:USOIL",
          "width": "100%",
          "colorTheme": "dark",
          "isTransparent": true,
          "locale": "kr"
        }
        </script>
      </div>
    </div>

    <!-- ✅ 미국 10년물 금리 대체: CBOE:TNX (보통 금리×10로 표시됨) -->
    <div class="summary-card">
      <div class="tradingview-widget-container">
        <script src="https://s3.tradingview.com/external-embedding/embed-widget-single-quote.js" async>
        {
          "symbol": "CBOE:TNX",
          "width": "100%",
          "colorTheme": "dark",
          "isTransparent": true,
          "locale": "kr"
        }
        </script>
      </div>

      <div class="summary-footnote">
        <span>※ TNX는 “10년물 금리 지수”로 표기값이 보통 <b>금리×10</b>입니다 (예: 41.70 → 4.170%).</span>
        <a href="https://m.stock.naver.com/marketindex/bond/US10YT=RR" target="_blank" rel="noopener"
           style="color:var(--muted); text-decoration:underline;">네이버(US10Y) 확인</a>
      </div>
    </div>

  </div>
</div>

<main>
  <section class="card half">
    <header>USD/KRW 환율 차트</header>
    <div id="tv_usdkrw" class="widget"></div>
  </section>

  <!-- ✅ 미국채 10년 Detail(차트) 섹션: 삭제 (AAPL 튐 원천 제거) -->

  <section class="card half">
    <header>WTI 원유 선물 차트</header>
    <div id="tv_wti" class="widget"></div>
  </section>

  <section class="card half">
    <header>Brent 원유 선물 차트</header>
    <div id="tv_brent" class="widget"></div>
  </section>
</main>

<script>
/* 상단 로컬 타임스탬프 */
function updateTimestamp(){
  const d = new Date();
  const pad = (n) => String(n).padStart(2, "0");
  const ts = `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
  const el = document.getElementById("ts");
  if (el) el.textContent = ts;
}
updateTimestamp();
setInterval(updateTimestamp, 1000);

/* TradingView Advanced Chart */
function createChart(id, symbol){
  new TradingView.widget({
    autosize: true,
    symbol,
    interval: "60",
    timezone: "Asia/Seoul",
    theme: "dark",
    style: "1",
    locale: "kr",
    enable_publishing: false,
    hide_top_toolbar: true,
    allow_symbol_change: false,
    save_image: false,
    container_id: id
  });
}

window.addEventListener("load", function(){
  createChart("tv_usdkrw", "FX_IDC:USDKRW");
  createChart("tv_wti", "TVC:USOIL");
  createChart("tv_brent", "TVC:UKOIL");
});
</script>

</body>
</html>
